{"basic_builder": {"appname": "TA-otx", "friendly_name": "Add-on for Open Threat Exchange", "version": "3.0.0", "author": "Luke Monahan <luke.monahan@tesserent.com>", "description": "This is a modular input which collects data from Open Threat Exchange for indexing in Splunk", "theme": "#65A637", "large_icon": "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", "small_icon": "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", "visible": true, "tab_version": "4.1.1", "tab_build_no": "0", "build_no": 3}, "data_input_builder": {"datainputs": [{"index": "default", "sourcetype": "otx:pulse", "interval": "3600", "use_external_validation": true, "streaming_mode_xml": true, "name": "otx", "title": "Open Threat Exchange Indicators", "description": "", "type": "customized", "parameters": [{"required": true, "name": "api_key", "label": "OTX API key", "placeholder": "", "default_value": "", "help_string": "", "type": "password", "format_type": "password", "value": "45871306cd4aa93992720fd5ab6950804c3a8d2a3b1de3dd50e34db9d81e7019"}, {"required": false, "name": "backfill_days", "label": "Backfill days", "default_value": "30", "placeholder": "", "help_string": "Number of days to backfill pulses and indicators for the first time the input runs", "type": "text", "format_type": "text", "value": "30"}], "data_inputs_options": [{"type": "customized_var", "name": "api_key", "title": "OTX API key", "description": "", "required_on_edit": false, "required_on_create": true, "format_type": "password", "default_value": "", "placeholder": ""}, {"type": "customized_var", "name": "backfill_days", "title": "Backfill days", "description": "Number of days to backfill pulses and indicators for the first time the input runs", "required_on_edit": false, "required_on_create": false, "format_type": "text", "default_value": "30", "placeholder": ""}], "code": "\n# encoding = utf-8\n\nimport os\nimport sys\nimport time\nimport datetime\n\nimport json\nimport hashlib\nimport calendar\nfrom datetime import datetime, timedelta\n\n\ndef utc_to_local(utc_dt):\n    timestamp = calendar.timegm(utc_dt.timetuple())\n    local_dt = datetime.fromtimestamp(timestamp)\n    assert utc_dt.resolution >= timedelta(microseconds=1)\n    return local_dt.replace(microsecond=utc_dt.microsecond)\n\ndef validate_input(helper, definition):\n    \"\"\"Implement your own validation logic to validate the input stanza configurations\"\"\"\n    #api_key = definition.parameters.get('api_key', None)\n    #backfill_days = definition.parameters.get('backfill_days', None)\n    pass\n\ndef collect_events(helper, ew):\n\n    api_key = helper.get_arg('api_key')\n    backfill_days = int(helper.get_arg('backfill_days'))\n\n    run_time = time.time()\n\n    last_ran = helper.get_check_point(hashlib.md5(helper.get_input_stanza_names().encode()).hexdigest())\n\n    if last_ran is None:\n      # Might be a migration from old version:\n      last_ran = helper.get_check_point('last_ran')\n      helper.delete_check_point('last_ran')\n\n\n    if last_ran is not None:\n      since = datetime.utcfromtimestamp(last_ran)\n    else:\n      since = datetime.now() - timedelta(days = backfill_days)\n\n    helper.log_info(\"Retrieving subscribed pulses since: %s\" % str(since))\n\n    response = helper.send_http_request(\n      'https://otx.alienvault.com/api/v1/pulses/subscribed',\n        'GET',\n        parameters = {'modified_since' : since },\n        headers = { 'X-OTX-API-KEY' : api_key },\n        verify=True,\n        use_proxy=True\n    )\n\n    response.raise_for_status()\n\n    pulses = response.json()['results']\n    \n    pulse_count = 0\n    indicator_count = 0\n    for pulse in pulses:\n\n        indicators = pulse.pop('indicators', None)\n\n        timeparts = pulse['modified'].split('.')\n        time_parsed = utc_to_local(datetime.strptime(timeparts[0], \"%Y-%m-%dT%H:%M:%S\"))\n        xtime = time.mktime(time_parsed.timetuple())\n\n        e = helper.new_event(\n            data = json.dumps(pulse),\n            time = xtime,\n            sourcetype = \"otx:pulse\",\n            index = helper.get_output_index(),\n            done = True\n    )\n        ew.write_event(e)\n\n        pulse_count = pulse_count + 1\n\n        for indicator in indicators:\n            indicator['pulse_id'] = pulse['id']\n\n            timeparts = indicator['created'].split('.')\n            time_parsed = utc_to_local(datetime.strptime(timeparts[0], \"%Y-%m-%dT%H:%M:%S\"))\n            xtime = time.mktime(time_parsed.timetuple())\n\n            e = helper.new_event(\n                data = json.dumps(indicator),\n                time = xtime,\n                sourcetype = \"otx:indicator\",\n                index = helper.get_output_index(),\n                done = True\n            )\n            ew.write_event(e)\n\n            indicator_count = indicator_count + 1\n\n    helper.log_info(\"Completed polling. Logged %d pulses and %d indicators.\" % (pulse_count, indicator_count))\n\n    helper.save_check_point(hashlib.md5(helper.get_input_stanza_names().encode()).hexdigest(), run_time)", "customized_options": [{"name": "backfill_days", "value": "30"}], "uuid": "ef6b6083e8f8489e81a54c0bd4f4f565", "sample_count": "5"}]}, "field_extraction_builder": {"otx:indicator": {"data_format": "json"}}, "global_settings_builder": {"global_settings": {"proxy_settings": {"proxy_type": "http"}, "log_settings": {}}}, "sourcetype_builder": {"otx:pulse": {"metadata": {"event_count": 0, "data_input_name": "otx", "extractions_count": 0, "cims_count": 0}}, "otx:indicator": {"metadata": {"event_count": 0, "data_input_name": null, "extractions_count": 0, "cims_count": 0}}}, "validation": {"validators": ["best_practice_validation", "data_model_mapping_validation", "field_extract_validation", "app_cert_validation"], "status": "job_finished", "validation_id": "v_1663135611_7", "progress": 1.0}}